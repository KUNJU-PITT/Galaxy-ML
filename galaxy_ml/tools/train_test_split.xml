<tool id="sklearn_train_test_split" name="Split Dataset" version="@VERSION@">
    <description>into train and test subsets</description>
    <macros>
        <import>main_macros.xml</import>
    </macros>
    <expand macro="python_requirements"/>
    <expand macro="macro_stdio"/>
    <version_command>echo "@VERSION@"</version_command>
    <command detect_errors="exit_code"><![CDATA[
        python '$__tool_directory__/train_test_split.py'
            --inputs '$inputs'
            --infile_array '$infile_array'
            #if $options.shuffle_selection.shuffle not in ['None', 'simple']
            --infile_labels '$options.shuffle_selection.labels'
            #end if
            --outfile_train '$out_train'
            --outfile_test '$out_test'
    ]]>
    </command>
    <configfiles>
        <inputs name="inputs"/>
    </configfiles>
    <inputs>
        <param name="infile_array" type="data" format="tabular" label="Select the dataset containing array to split"/>
        <param name="infile_info" type="select" multiple="true" display="checkboxes" optional="true" label="The dataset">
            <option value="header" selected="true">Has headers</option>
        </param>
        <section name="options" title="Options" expanded="true">
            <param argument="test_size" type="float" optional="False" value="0.25" label="Test size:"
                help="If float, should be between 0.0 and 1.0 and represent the proportion of the dataset to include in the test split. If int, represents the absolute number of test samples."/>
            <param argument="random_state" type="integer" optional="True" value="" label="Random seed number:"/>
            <conditional name="shuffle_selection">
                <param name="shuffle" type="select" label="Splitting strategy">
                    <option value="None">None - No shuffle</option>
                    <option value="simple">Shuffle Split</option>
                    <option value="stratified">Stratified Shuffle Split</option>
                    <option value="group">Group Shuffle Split</option>
                    <option value="ordered_target">Ordered Target Split -- Single split from `galaxy_ml.model_validations.OrderedKFold`</option>
                </param>
                <when value="None"/>
                <when value="simple"/>
                <when value="stratified">
                    <param name="labels" type="data" format="tabular" label="Select the dataset containing labels"/>
                    <param name="infile_info" type="select" multiple="true" display="checkboxes" optional="true" label="The dataset">
                        <option value="header" selected="true">Has headers</option>
                    </param>
                    <param name="col" type="data_column" data_ref="labels" label="Select target column"/>
                </when>
                <when value="group">
                    <param name="labels" type="data" format="tabular" label="Select the dataset containing groups"/>
                    <param name="infile_info" type="select" multiple="true" display="checkboxes" optional="true" label="The dataset">
                        <option value="header" selected="true">Has headers</option>
                    </param>
                    <param name="col" type="data_column" data_ref="labels" label="Select target column"/>
                </when>
                <when value="ordered_target">
                    <param name="labels" type="data" format="tabular" label="Select the dataset containing target values"/>
                    <param name="infile_info" type="select" multiple="true" display="checkboxes" optional="true" label="The dataset">
                        <option value="header" selected="true">Has headers</option>
                    </param>
                    <param name="col" type="data_column" data_ref="labels" label="Select target column"/>
                </when>
            </conditional>
        </section>
    </inputs>
    <outputs>
        <data format="tabular" name="out_train" label="${tool.name} on ${on_string} (train)"/>
        <data format="tabular" name="out_test" label="${tool.name} on ${on_string} (test)"/>
    </outputs>
    <tests>
        <test>
            <param name="infile_array" value="regression_X.tabular" ftype="tabular"/>
            <param name="infile_info" value="header"/>
            <param name="random_state" value="123"/>
            <param name="shuffle" value="simple"/>
            <output name="out_train" file="train_test_split_train01.tabular" ftype="tabular"/>
            <output name="out_test" file="train_test_split_test01.tabular" ftype="tabular"/>
        </test>
        <test>
            <param name="infile_array" value="imblearn_X.tabular" ftype="tabular"/>
            <param name="infile_info" value="None"/>
            <param name="test_size" value="0.2"/>
            <param name="random_state" value="123"/>
            <param name="shuffle" value="stratified"/>
            <conditional name="shuffle_selection">
                <param name="labels" value="imblearn_y.tabular" ftype="tabular"/>
                <param name="infile_info" value="None"/>
                <param name="col" value="1"/>
            </conditional>
            <output name="out_train" file="train_test_split_train02.tabular" ftype="tabular"/>
            <output name="out_test" file="train_test_split_test02.tabular" ftype="tabular"/>
        </test>
        <test>
            <param name="infile_array" value="regression_X.tabular" ftype="tabular"/>
            <param name="infile_info" value="header"/>
            <param name="test_size" value="0.2"/>
            <param name="random_state" value="123"/>
            <param name="shuffle" value="ordered_target"/>
            <conditional name="shuffle_selection">
                <param name="labels" value="regression_y.tabular" ftype="tabular"/>
                <param name="infile_info" value="header"/>
                <param name="col" value="1"/>
            </conditional>
            <output name="out_train" file="train_test_split_train03.tabular" ftype="tabular"/>
            <output name="out_test" file="train_test_split_test03.tabular" ftype="tabular"/>
        </test>
    </tests>
    <help><![CDATA[
Input: a tabular file. Header is allowed.

Output: two tabular files containing train and test set, respectively.

    ]]></help>
    <expand macro="sklearn_citation"/>
</tool>